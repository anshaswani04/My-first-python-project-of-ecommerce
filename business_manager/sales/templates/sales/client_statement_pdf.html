<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <style>
        body { font-family: Helvetica, Arial, sans-serif; font-size: 12px; }
        h1, h3 { text-align: center; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #000;
            padding: 6px;
        }
        th {
            background: #f0f0f0;
        }
    </style>
</head>
<body>

<h1>Client Statement</h1>

<p>
<strong>Name:</strong> {{ client.name }}<br>
<strong>Phone:</strong> {{ client.phone }}<br>
<strong>Address:</strong> {{ client.address }}
</p>

<hr>

<p>
<strong>Total Billed:</strong> ₹{{ total_billed }}<br>
<strong>Total Paid:</strong> ₹{{ total_paid }}<br>
<strong>Total Pending:</strong> ₹{{ total_pending }}
</p>

<table>
<tr>
    <th>Date</th>
    <th>Bill No</th>
    <th>Bill Amount</th>
    <th>Payments</th>
    <th>Paid</th>
    <th>Pending</th>
</tr>

{% for bill in bills %}
<tr>
    <td>{{ bill.bill_date }}</td>
    <td>{{ bill.bill_number }}</td>
    <td>₹{{ bill.total_amount }}</td>
    <td>
        {% for payment in bill.payments.all %}
            ₹{{ payment.amount }} ({{ payment.payment_mode }})
            {% if payment.payment_mode == 'cheque' %}
                - {{ payment.cheque_number }}
            {% endif %}
            <br>
        {% empty %}
            —
        {% endfor %}
    </td>
    <td>₹{{ bill.paid_amount }}</td>
    <td>₹{{ bill.pending_amount }}</td>
</tr>
{% endfor %}

</table>

<p style="margin-top:20px; text-align:center;">
Generated on {{ now }}
</p>

</body>
</html>
